<!DOCTYPE html>
<html class="no-js" lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1">

	<title>生产调度</title>
	
	<!-- vue ajax -->
	<script src="js/jquery.min.js"></script>
	<script src="bootstrap/dist/js/bootstrap.min.js"></script>
	
	<script src="js/vue.js"></script>
	<script src="js/axios.min.js"></script>
    <!-- favicon
		============================================ -->
    <link rel="shortcut icon" type="image/x-icon" href="img/favicon.ico">
    <!-- Google Fonts
		============================================ -->
   <!-- <link href="https://fonts.googleapis.com/css?family=Roboto:100,300,400,700,900" rel="stylesheet"> -->
    <!-- Bootstrap CSS
		============================================ -->
    <link rel="stylesheet" href="css/bootstrap.min.css">
    <!-- Bootstrap CSS
		============================================ -->
    <link rel="stylesheet" href="css/font-awesome.min.css">
    <!-- owl.carousel CSS
		============================================ -->
    <link rel="stylesheet" href="css/owl.carousel.css">
    <link rel="stylesheet" href="css/owl.theme.css">
    <link rel="stylesheet" href="css/owl.transitions.css">
    <!-- animate CSS
		============================================ -->
    <link rel="stylesheet" href="css/animate.css">
    <!-- normalize CSS
		============================================ -->
    <link rel="stylesheet" href="css/normalize.css">
    <!-- meanmenu icon CSS
		============================================ -->
    <link rel="stylesheet" href="css/meanmenu.min.css">
    <!-- main CSS
		============================================ -->
    <link rel="stylesheet" href="css/main.css">
    <!-- educate icon CSS
		============================================ -->
    <link rel="stylesheet" href="css/educate-custon-icon.css">
    <!-- morrisjs CSS
		============================================ -->
    <link rel="stylesheet" href="css/morrisjs/morris.css">
    <!-- mCustomScrollbar CSS
		============================================ -->
    <link rel="stylesheet" href="css/scrollbar/jquery.mCustomScrollbar.min.css">
    <!-- metisMenu CSS
		============================================ -->
    <link rel="stylesheet" href="css/metisMenu/metisMenu.min.css">
    <link rel="stylesheet" href="css/metisMenu/metisMenu-vertical.css">
    <!-- calendar CSS
		============================================ -->
    <link rel="stylesheet" href="css/calendar/fullcalendar.min.css">
    <link rel="stylesheet" href="css/calendar/fullcalendar.print.min.css">
    <!-- style CSS
		============================================ -->
    <link rel="stylesheet" href="css/style.css">
    <!-- responsive CSS
		============================================ -->
    <link rel="stylesheet" href="css/responsive.css">
    <!-- modernizr JS
		============================================ -->
    <script src="js/vendor/modernizr-2.8.3.min.js"></script>
	<style>
		.add-schedule a {
			float: right;
			position: absolute;
			top: 20px;
			right: 35px;
			display: block;
			background: #006DF0;
			/* width: 120px; */
			padding: 6px 20px;
			/* margin: 0px 1100px; */
			color: #fff;
			border-radius: 4px;
		}
		.search-order a {
			/* float: right; */
			/* position: absolute;
            top: 40px;
            right: 35px; */
			display: block;
			background: #006DF0;
			width: 120px;
			font-size: 15px;
			padding: 6px 20px;
			margin: 0px 70px;
			color: #fff;
			border-radius: 4px;
			text-align: center;
		}
		.input-group-addon{
			color: white;
			background-color: #009AD5;
		}
	</style>
</head>

<body>
    <!--[if lt IE 8]>
		<p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</p>
	<![endif]-->
    <!-- Start Left menu area -->
    <div class="left-sidebar-pro">
      <nav id="sidebar" class="">
          <div class="sidebar-header">
              <a href="index.html"><img class="main-logo" src="img/logo/logo.png" alt="" /></a>
              <strong><a href="index.html"><img src="img/logo/logosn.png" alt="" /></a></strong>
          </div>
          <div class="left-custom-menu-adp-wrap comment-scrollbar">
              <nav class="sidebar-nav left-sidebar-menu-pro">
                  <ul class="metismenu" id="menu1">
					  <li>
						  <a title="Landing Page" href="/login.html" aria-expanded="false"><span class="educate-icon educate-professor icon-wrap sub-icon-mg" aria-hidden="true"></span> <span class="mini-click-non">登录/注册</span></a>
					  </li>
					  <li>
						  <a title="Landing Page" href="/index.html" aria-expanded="false"><span class="educate-icon educate-apps icon-wrap sub-icon-mg" aria-hidden="true"></span> <span class="mini-click-non">工厂首页</span></a>
					  </li>
					  <li>
						  <a title="Landing Page" href="/product.html" aria-expanded="false"><span class="educate-icon educate-event icon-wrap sub-icon-mg" aria-hidden="true"></span> <span class="mini-click-non">产品管理</span></a>
					  </li>
					  <li>
						  <a title="Landing Page" href="/equipment.html" aria-expanded="false"><span class="educate-icon educate-event icon-wrap sub-icon-mg" aria-hidden="true"></span> <span class="mini-click-non">设备管理</span></a>
					  </li>
					  <li>
						  <a title="Landing Page" href="/order.html" aria-expanded="false"><span class="educate-icon educate-library icon-wrap sub-icon-mg" aria-hidden="true"></span> <span class="mini-click-non">订单管理</span></a>
					  </li>
					  <li>
						  <a title="Landing Page" href="/planmanage.html" aria-expanded="false"><span class="educate-icon educate-data-table icon-wrap sub-icon-mg" aria-hidden="true"></span> <span class="mini-click-non">生产计划管理</span></a>
					  </li>
					  <li>
						  <a title="Landing Page" href="/schedule.html" aria-expanded="false"><span class="educate-icon educate-event icon-wrap sub-icon-mg" aria-hidden="true"></span> <span class="mini-click-non">生产调度管理</span></a>
					  </li>
					  <li>
						  <a title="Landing Page" href="/ordertrack.html" aria-expanded="false"><span class="educate-icon educate-interface icon-wrap sub-icon-mg" aria-hidden="true"></span> <span class="mini-click-non">生产订单跟踪</span></a>
					  </li>
                  </ul>
              </nav>
          </div>
      </nav>
  </div>
  <!-- End Left menu area -->
 
    <div class="all-content-wrapper" id="app"> 
		<div class="container-fluid">
            <div class="row">
                <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
                    <div class="logo-pro">
                        <a href="index.html"><img class="main-logo" src="img/logo/logo.png" alt="" /></a>
                    </div>
                </div>
            </div>
        </div>
		<div class="header-advance-area">
			<div class="header-top-area">
				<div class="container-fluid">
					<div class="row">
						<div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
							<div class="header-top-wraper">
								<div class="row">
									<div class="col-lg-1 col-md-0 col-sm-1 col-xs-12">
										<div class="menu-switcher-pro">
											<button type="button" id="sidebarCollapse" class="btn bar-button-pro header-drl-controller-btn btn-info navbar-btn">
												<i class="educate-icon educate-nav"></i>
											</button>
										</div>
									</div>
									<div class="col-lg-6 col-md-7 col-sm-6 col-xs-12">
										<div class="header-top-menu tabl-d-n">
											<ul class="nav navbar-nav mai-top-nav">
												<li class="nav-item"><a href="#" class="nav-link">Home</a>
												</li>
											</ul>
										</div>
									</div>
									<div class="col-lg-5 col-md-5 col-sm-12 col-xs-12">
										<div class="header-right-info">
											<ul class="nav navbar-nav mai-top-nav header-right-menu">

												<li class="nav-item">
													<a href="#" data-toggle="dropdown" role="button" aria-expanded="false" class="nav-link dropdown-toggle">
														<img src="" alt="" />
														<span class="admin-name">{{userName}}</span>
														<i class="fa fa-angle-down edu-icon edu-down-arrow"></i>
													</a>
													<ul role="menu" class="dropdown-header-top author-log dropdown-menu animated zoomIn">
														<li><a @click="logout()"><span class="edu-icon edu-locked author-log-ic"></span>Log Out</a>
														</li>
													</ul>
												</li>
											</ul>
										</div>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>

			<div class="mobile-menu-area">
				<div class="container">
					<div class="row">
						<div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
							<div class="mobile-menu">
								<nav id="dropdown">
									<ul class="mobile-menu-nav">
										<li><a data-toggle="collapse" data-target="#Charts" href="#">Home <span class="admin-project-icon edu-icon edu-down-arrow"></span></a>
											<ul class="collapse dropdown-header-top">
												<li><a href="index.html">Dashboard v.1</a></li>
												<li><a href="index-1.html">Dashboard v.2</a></li>
												<li><a href="index-3.html">Dashboard v.3</a></li>
												<li><a href="analytics.html">Analytics</a></li>
												<li><a href="widgets.html">Widgets</a></li>
											</ul>
										</li>
										<li><a href="events.html">Event</a></li>
										<li><a data-toggle="collapse" data-target="#demoevent" href="#">Professors <span class="admin-project-icon edu-icon edu-down-arrow"></span></a>
											<ul id="demoevent" class="collapse dropdown-header-top">
												<li><a href="all-professors.html">All Professors</a>
												</li>
												<li><a href="add-professor.html">Add Professor</a>
												</li>
												<li><a href="edit-professor.html">Edit Professor</a>
												</li>
												<li><a href="professor-profile.html">Professor Profile</a>
												</li>
											</ul>
										</li>
										<li><a data-toggle="collapse" data-target="#demopro" href="#">Students <span class="admin-project-icon edu-icon edu-down-arrow"></span></a>
											<ul id="demopro" class="collapse dropdown-header-top">
												<li><a href="all-students.html">All Students</a>
												</li>
												<li><a href="add-student.html">Add Student</a>
												</li>
												<li><a href="edit-student.html">Edit Student</a>
												</li>
												<li><a href="student-profile.html">Student Profile</a>
												</li>
											</ul>
										</li>
										<li><a data-toggle="collapse" data-target="#democrou" href="#">Courses <span class="admin-project-icon edu-icon edu-down-arrow"></span></a>
											<ul id="democrou" class="collapse dropdown-header-top">
												<li><a href="all-courses.html">All Courses</a>
												</li>
												<li><a href="add-course.html">Add Course</a>
												</li>
												<li><a href="edit-course.html">Edit Course</a>
												</li>
												<li><a href="course-profile.html">Courses Info</a>
												</li>
												<li><a href="course-payment.html">Courses Payment</a>
												</li>
											</ul>
										</li>
										<li><a data-toggle="collapse" data-target="#demolibra" href="#">Library <span class="admin-project-icon edu-icon edu-down-arrow"></span></a>
											<ul id="demolibra" class="collapse dropdown-header-top">
												<li><a href="library-assets.html">Library Assets</a>
												</li>
												<li><a href="add-library-assets.html">Add Library Asset</a>
												</li>
												<li><a href="edit-library-assets.html">Edit Library Asset</a>
												</li>
											</ul>
										</li>
										<li><a data-toggle="collapse" data-target="#demodepart" href="#">Departments <span class="admin-project-icon edu-icon edu-down-arrow"></span></a>
											<ul id="demodepart" class="collapse dropdown-header-top">
												<li><a href="departments.html">Departments List</a>
												</li>
												<li><a href="add-department.html">Add Departments</a>
												</li>
												<li><a href="edit-department.html">Edit Departments</a>
												</li>
											</ul>
										</li>
										<li><a data-toggle="collapse" data-target="#demo" href="#">Mailbox <span class="admin-project-icon edu-icon edu-down-arrow"></span></a>
											<ul id="demo" class="collapse dropdown-header-top">
												<li><a href="mailbox.html">Inbox</a>
												</li>
												<li><a href="mailbox-view.html">View Mail</a>
												</li>
												<li><a href="mailbox-compose.html">Compose Mail</a>
												</li>
											</ul>
										</li>
										<li><a data-toggle="collapse" data-target="#Miscellaneousmob" href="#">Interface <span class="admin-project-icon edu-icon edu-down-arrow"></span></a>
											<ul id="Miscellaneousmob" class="collapse dropdown-header-top">
												<li><a href="google-map.html">Google Map</a>
												</li>
												<li><a href="data-maps.html">Data Maps</a>
												</li>
												<li><a href="pdf-viewer.html">Pdf Viewer</a>
												</li>
												<li><a href="x-editable.html">X-Editable</a>
												</li>
												<li><a href="code-editor.html">Code Editor</a>
												</li>
												<li><a href="tree-view.html">Tree View</a>
												</li>
												<li><a href="preloader.html">Preloader</a>
												</li>
												<li><a href="images-cropper.html">Images Cropper</a>
												</li>
											</ul>
										</li>
										<li><a data-toggle="collapse" data-target="#Chartsmob" href="#">Charts <span class="admin-project-icon edu-icon edu-down-arrow"></span></a>
											<ul id="Chartsmob" class="collapse dropdown-header-top">
												<li><a href="bar-charts.html">Bar Charts</a>
												</li>
												<li><a href="line-charts.html">Line Charts</a>
												</li>
												<li><a href="area-charts.html">Area Charts</a>
												</li>
												<li><a href="rounded-chart.html">Rounded Charts</a>
												</li>
												<li><a href="c3.html">C3 Charts</a>
												</li>
												<li><a href="sparkline.html">Sparkline Charts</a>
												</li>
												<li><a href="peity.html">Peity Charts</a>
												</li>
											</ul>
										</li>
										<li><a data-toggle="collapse" data-target="#Tablesmob" href="#">Tables <span class="admin-project-icon edu-icon edu-down-arrow"></span></a>
											<ul id="Tablesmob" class="collapse dropdown-header-top">
												<li><a href="static-table.html">Static Table</a>
												</li>
												<li><a href="data-table.html">Data Table</a>
												</li>
											</ul>
										</li>
										<li><a data-toggle="collapse" data-target="#formsmob" href="#">Forms <span class="admin-project-icon edu-icon edu-down-arrow"></span></a>
											<ul id="formsmob" class="collapse dropdown-header-top">
												<li><a href="basic-form-element.html">Basic Form Elements</a>
												</li>
												<li><a href="advance-form-element.html">Advanced Form Elements</a>
												</li>
												<li><a href="password-meter.html">Password Meter</a>
												</li>
												<li><a href="multi-upload.html">Multi Upload</a>
												</li>
												<li><a href="tinymc.html">Text Editor</a>
												</li>
												<li><a href="dual-list-box.html">Dual List Box</a>
												</li>
											</ul>
										</li>
										<li><a data-toggle="collapse" data-target="#Appviewsmob" href="#">App views <span class="admin-project-icon edu-icon edu-down-arrow"></span></a>
											<ul id="Appviewsmob" class="collapse dropdown-header-top">
												<li><a href="basic-form-element.html">Basic Form Elements</a>
												</li>
												<li><a href="advance-form-element.html">Advanced Form Elements</a>
												</li>
												<li><a href="password-meter.html">Password Meter</a>
												</li>
												<li><a href="multi-upload.html">Multi Upload</a>
												</li>
												<li><a href="tinymc.html">Text Editor</a>
												</li>
												<li><a href="dual-list-box.html">Dual List Box</a>
												</li>
											</ul>
										</li>
										<li><a data-toggle="collapse" data-target="#Pagemob" href="#">Pages <span class="admin-project-icon edu-icon edu-down-arrow"></span></a>
											<ul id="Pagemob" class="collapse dropdown-header-top">
												<li><a href="login.html">Login</a>
												</li>
												<li><a href="register.html">Register</a>
												</li>
												<li><a href="lock.html">Lock</a>
												</li>
												<li><a href="password-recovery.html">Password Recovery</a>
												</li>
												<li><a href="404.html">404 Page</a></li>
												<li><a href="500.html">500 Page</a></li>
											</ul>
										</li>
									</ul>
								</nav>
							</div>
						</div>
					</div>
				</div>
			</div>

			<div class="breadcome-area">
				<div class="container-fluid">
					<div class="row">
						<div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
							<div class="breadcome-list single-page-breadcome">
								<div class="row">
									<div class="col-lg-10 col-md-10 col-sm-10 col-xs-12 form-horizontal">
										<div class="col-lg-3">
											<div class="input-group" >
												<span class="input-group-addon">计划编号</span>
												<input type="text" placeholder="计划编号" class="form-control" ref="search_planSeq">
											</div>
										</div>
										<div class="col-lg-3 ">
											<div class="input-group" >
												<span class="input-group-addon">工单编号</span>
												<input type="text" placeholder="工单编号" class="form-control" ref="search_scheduleSeq">
											</div>
										</div>
										<div class="col-lg-3 ">
											<div class="input-group" >
												<span class="input-group-addon">产品名称</span>
												<input type="text" placeholder="产品名称" class="form-control" ref="search_productName">
											</div>
										</div>
										<div class="col-lg-3 search-order">
											<a href="#" @click.prevent="submitSearch(1)"><i class="fa fa-search"></i>查询工单</a>
										</div>
									</div>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>


		</div>
		    
        <div class="product-status mg-b-15">
            <div class="container-fluid">
                <div class="row">
                    <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
                        <div class="product-status-wrap">							
							<div class="add-schedule" data-toggle="modal"
							 data-target="#myModalAddSchedule" @click="level1 = {};">
								<a href="#">新建工单</a>
							</div>
							<h4>工单列表</h4>
                            <div class="asset-inner">
                            	<table>
                            		<tr>
                            			<th>计划编号</th>
                            			<th>产品</th>
                            			<th>计划数量</th>
                            			<th>产品数量</th>
                            			<th>工单号</th>
                            			<th>设备序列号</th>
                            			<th>开始日期</th>
                            			<th>结束日期</th>
                            			<th>工单状态</th>
                            			<th style="width: 200px; text-align: center;">操作</th>
                            		</tr>
                            		<tr v-for="(schedule, index) in schedules">
										
										
                            
                            			<td>{{schedule.planSeq}}</td>
                            			<td>{{schedule.productName}}</td>
                            			<td>{{schedule.planCount}}</td>
                            			<td>{{schedule.scheduleCount}}</td>
										<td>{{schedule.scheduleSeq}}</td>
                            			<td>{{schedule.equipmentSeq}}</td>
										<td>{{schedule.startDate}}</td>
										<td>{{schedule.endDate}}</td>
                            			<td>
                            				<button class="pd-setting" v-if="schedule.scheduleStatus == 1" >未开始</button>
                            				<button class="du-setting" v-if="schedule.scheduleStatus == 2" >生产中</button>
                            				<button class="su-setting" v-if="schedule.scheduleStatus == 3" >已完成</button>
                            			</td>
                            			<td style="text-align: center">
											
                            				<button data-toggle="tooltip" title="Edit" class="pd-setting-ed" v-if="schedule.scheduleStatus == 1"
                            						@click="changeStatus(index, 2)">
                            					<i class="fa fa-play-circle" aria-hidden="true" ></i>启动</button>
												
											<button data-toggle="modal" title="Edit" class="pd-setting-ed" v-if="schedule.scheduleStatus == 1"
													data-target="#myModalUpdateSchedule" @click="updateSchedule = schedules[index];">
												<i class="fa fa-pencil-square-o" aria-hidden="true"></i>编辑</button>
											
											<button data-toggle="tooltip" title="Delete" class="pd-setting-ed" v-if="schedule.scheduleStatus == 1"
													@click="deleteSchedule(index)">
												<i class="fa fa-trash-o" aria-hidden="true"></i>删除</button>
									
                            				<button data-toggle="modal" title="Search" class="pd-setting-ed"
													data-target="#myModalCheckSchedule" @click="checkSchedule = schedules[index];">
												<i class="fa fa-search" aria-hidden="true"></i>查看</button>
                            			</td>
                            		</tr>
                            	</table>
                            </div>
							
							<!-- 分页-->
							<ul class="pagination">
							
							</ul>
							<div class="custom-pagination">
								<ul class="pagination"> 
									<li class="page-item"><a class="page-link" href="#"
															 @click="pages.pageNo == 1 ? pages.pageNo = 1 : pages.pageNo -= 1; getScheduleByPage(pages.pageNo);">上一页</a></li>
									<li   v-for="i in pages.totalPage"  :class="[pages.pageNo != i ? '':'active']" >
										<a href="#" @click.prevent="searchScheduleByPage(i)">{{i}}</a>
									</li>
							
									<li class="page-item"><a class="page-link" href="#"
															 @click="pages.pageNo == pages.totalPage ? pages.pageNo = pages.totalPage : pages.pageNo += 1; searchScheduleByPage(pages.pageNo);">下一页</a></li>
								</ul>
							</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

		<!--新建工单的模态框-->
		<div class="modal fade" id="myModalAddSchedule"
				 tabindex="-1" role="dialog"
				 aria-labelledby="myModalLabel" aria-hidden="true" >
				<div class="modal-dialog">
					<div class="modal-content">
						<div class="modal-header">
							<button type="button" class="close" data-dismiss="modal" aria-hidden="true">
								&times;
							</button>
							<h4 class="modal-title" id="myModalAddLabel">
								新建工单
							</h4>
						</div>
						<div class="modal-body form-horizontal" style="height: 400px;">


							<div class="form-group col-lg-12">
								<label for="pseq" class="col-lg-3 control-label">计划编号：</label>
								<div class="col-lg-9">
									<select class="form-control" tabindex="-1" id="pseq" name="pseq" v-model="level1">
										<option value="">请选择计划</option>
										<option v-for="plan in plans" :value="plan">{{plan.planSeq}}</option>
									</select>
								</div>
							</div>

							<div class="form-group col-lg-12">
								<label for="pname" class="col-lg-3 control-label">产品名称：</label>
								<div class="col-lg-9">
									<input type="text" class="form-control" id="pname" disabled="true" name="pname" :value="level1.productName"/>
								</div>
								<span id="IdErr" class="text-danger"></span>
							</div>

							<div class="form-group col-lg-12">
								<label for="pnum" class="col-lg-3 control-label">计划数量：</label>
								<div class="col-lg-9">
									<input type="text" class="form-control" id="pnum" name="pnum" disabled="true"  :value="level1.planCount"/>
								</div>
							</div>

							<div class="form-group col-lg-12">
								<label for="pname" class="col-lg-3 control-label">设备序列号：</label>
								<div class="col-lg-9">
									<select class="form-control" tabindex="-1" id="eSeq" name="eSeq" v-model="equipmentId">
										<option value="">请选择设备</option>
										<option v-for="equipment in equipments" v-if="equipment.productId == level1.productId" :value="equipment.id">{{equipment.equipmentSeq}}</option>
									</select>
								</div>
							</div>

							<div class="form-group col-lg-12">
								<label for="snum" class="col-lg-3 control-label">工单数量：</label>
								<div class="col-lg-9">
									<input type="text" class="form-control" id="snum" name="snum" placeholder="输入工单数量" v-model="scheduleCount"/>
								</div>
							</div>

							<div class="form-group  col-lg-12" id="data_2">
								<label for="addStdate" class="col-lg-3 control-label">开始日期:</label>
								<div class="input-group date col-lg-9">
									<span class="input-group-addon"><i class="fa fa-calendar"></i></span>
									<input type="text" class="form-control" id="addStdate" ref="addStDate" />
								</div>
							</div>

							<div class="form-group  col-lg-12" id="data_2">
								<label for="addendDate" class="col-lg-3 control-label">结束日期：</label>
								<div class="input-group date col-lg-9">
									<span class="input-group-addon"><i class="fa fa-calendar"></i></span>
									<input type="text" class="form-control" id="addendDate" ref="addEndDate" />
								</div>
							</div>



							<!--					<p v-if="errors.length">-->
							<!--					<ul>-->
							<!--						<li class="text-danger" v-for="error in errors">{{ error }}</li>-->
							<!--					</ul>-->
							<!--					</p>-->




						</div>

						<div class="modal-footer">
							<div>
								<button type="button" ref="btnClose" class="btn btn-default"
										data-dismiss="modal">关闭
								</button>
								<button type="button" class="btn btn-primary" @click="submitAddSchedule()">
									创建
								</button>
							</div>
						</div>
					</div><!-- /.modal-content -->
				</div><!-- /.modal -->
			</div>

		<!--查看工单的模态框-->
		<div class="modal fade" id="myModalCheckSchedule"
			 tabindex="-1" role="dialog"
			 aria-labelledby="myModalLabel" aria-hidden="true" >
			<div class="modal-dialog">
				<div class="modal-content">
					<div class="modal-header">
						<button type="button" class="close" data-dismiss="modal" aria-hidden="true">
							&times;
						</button>
						<h4 class="modal-title" id="myModalCheckLabel">
							查看工单
						</h4>
					</div>
					<div class="modal-body form-horizontal" style="height: 400px;">


						<div class="form-group col-lg-12">
							<label for="chpseq" class="col-lg-3 control-label">计划编号：</label>
							<div class="col-lg-9">
								<input type="text" class="form-control" id="chpseq" disabled="true" name="pseq" :value="checkSchedule.planSeq"/>
							</div>
						</div>

						<div class="form-group col-lg-12">
							<label for="chpname" class="col-lg-3 control-label">产品名称：</label>
							<div class="col-lg-9">
								<input type="text" class="form-control" id="chpname" disabled="true" name="chpname" :value="checkSchedule.productName"/>
							</div>
						</div>

						<div class="form-group col-lg-12">
							<label for="chpnum" class="col-lg-3 control-label">计划数量：</label>
							<div class="col-lg-9">
								<input type="text" class="form-control" id="chpnum" name="chpnum" disabled="true"  :value="checkSchedule.planCount"/>
							</div>
						</div>

						<div class="form-group col-lg-12">
							<label for="cheSeq" class="col-lg-3 control-label">设备序列号</label>
							<div class="col-lg-9">
								<input type="text" class="form-control" id="cheSeq" name="cheSeq" disabled="true"  :value="checkSchedule.equipmentSeq"/>
							</div>
						</div>

						<div class="form-group col-lg-12">
							<label for="chsnum" class="col-lg-3 control-label">工单数量：</label>
							<div class="col-lg-9">
								<input type="text" class="form-control" id="chsnum" name="chsnum" disabled="true"  v-model="checkSchedule.scheduleCount"/>
							</div>
						</div>

						<div class="form-group  col-lg-12" id="data_2">
							<label for="chStdate" class="col-lg-3 control-label">开始日期:</label>
							<div class="input-group date col-lg-9">
								<span class="input-group-addon"><i class="fa fa-calendar"></i></span>
								<input type="text" class="form-control" id="chStdate" disabled="true"  v-model="checkSchedule.startDate"/>
							</div>
						</div>

						<div class="form-group  col-lg-12" id="data_2">
							<label for="chEndDate" class="col-lg-3 control-label">结束日期：</label>
							<div class="input-group date col-lg-9">
								<span class="input-group-addon"><i class="fa fa-calendar"></i></span>
								<input type="text" class="form-control" id="chEndDate" disabled="true"  v-model="checkSchedule.endDate" />
							</div>
						</div>




					</div>

					<div class="modal-footer">
						<div>
							<button type="button" ref="btnClose1" class="btn btn-default"
								data-dismiss="modal">关闭
							</button>
						</div>
					</div>
				</div><!-- /.modal-content -->
			</div><!-- /.modal -->
		</div>

		<!--编辑工单的模态框-->
		<div class="modal fade" id="myModalUpdateSchedule"
			 tabindex="-1" role="dialog"
			 aria-labelledby="myModalLabel" aria-hidden="true" >
			<div class="modal-dialog">
				<div class="modal-content">
					<div class="modal-header">
						<button type="button" class="close" data-dismiss="modal" aria-hidden="true">
							&times;
						</button>
						<h4 class="modal-title" id="myModalUpdateLabel">
							查看工单
						</h4>
					</div>
					<div class="modal-body form-horizontal" style="height: 400px;">


						<div class="form-group col-lg-12">
							<label for="uppseq" class="col-lg-3 control-label">计划编号：</label>
							<div class="col-lg-9">
								<input type="text" class="form-control" id="uppseq" disabled="true" name="uppseq" :value="updateSchedule.planSeq"/>
							</div>
						</div>

						<div class="form-group col-lg-12">
							<label for="uppname" class="col-lg-3 control-label">产品名称：</label>
							<div class="col-lg-9">
								<input type="text" class="form-control" id="uppname" disabled="true" name="uppname" :value="updateSchedule.productName"/>
							</div>
						</div>

						<div class="form-group col-lg-12">
							<label for="uppnum" class="col-lg-3 control-label">计划数量：</label>
							<div class="col-lg-9">
								<input type="text" class="form-control" id="uppnum" name="uppnum" disabled="true"  :value="updateSchedule.planCount"/>
							</div>
						</div>

						<div class="form-group col-lg-12">
							<label for="upeSeq" class="col-lg-3 control-label">设备序列号</label>
							<div class="col-lg-9">
								<select class="form-control" tabindex="-1" id="upeSeq" name="eSeq" v-model="upEquipmentId">
									<option value="">请选择设备</option>
									<option v-for="equipment in equipments" v-if="equipment.productId == updateSchedule.productId" :value="equipment.id">{{equipment.equipmentSeq}}</option>
								</select>
							</div>
						</div>

						<div class="form-group col-lg-12">
							<label for="upsnum" class="col-lg-3 control-label">工单数量：</label>
							<div class="col-lg-9">
								<input type="text" class="form-control" id="upsnum" name="upsnum"  v-model="upScheduleCount"/>
							</div>
						</div>

						<div class="form-group  col-lg-12" id="data_2">
							<label for="upStdate" class="col-lg-3 control-label">开始日期:</label>
							<div class="input-group date col-lg-9">
								<span class="input-group-addon"><i class="fa fa-calendar"></i></span>
								<input type="text" class="form-control" id="upStdate"  ref="upStartDate"/>
							</div>
						</div>

						<div class="form-group  col-lg-12" id="data_2">
							<label for="upEndDate" class="col-lg-3 control-label">结束日期：</label>
							<div class="input-group date col-lg-9">
								<span class="input-group-addon"><i class="fa fa-calendar"></i></span>
								<input type="text" class="form-control" id="upEndDate"  ref="upEndDate" />
							</div>
						</div>




					</div>

					<div class="modal-footer">
						<div>
							<button type="button" ref="btnClose2" class="btn btn-default"
									data-dismiss="modal">关闭
							</button>
							<button type="button" class="btn btn-primary" @click="submitUpdateSchedule()">
								修改
							</button>
						</div>
					</div>
				</div><!-- /.modal-content -->
			</div><!-- /.modal -->
		</div>
		

		
		
		
		
		
		<!-- 主内容结束 -->
	</div>
	<!-- 模态框（Modal） -->



	<!-- jquery
        ============================================ -->
	<script src="js/vendor/jquery-1.12.4.min.js"></script>
	<!-- bootstrap JS
        ============================================ -->
	<script src="js/bootstrap.min.js"></script>
	<!-- wow JS
        ============================================ -->
	<script src="js/wow.min.js"></script>
	<!-- price-slider JS
        ============================================ -->
	<script src="js/jquery-price-slider.js"></script>
	<!-- meanmenu JS
        ============================================ -->
	<script src="js/jquery.meanmenu.js"></script>
	<!-- owl.carousel JS
        ============================================ -->
	<script src="js/owl.carousel.min.js"></script>
	<!-- sticky JS
        ============================================ -->
	<script src="js/jquery.sticky.js"></script>
	<!-- scrollUp JS
        ============================================ -->
	<script src="js/jquery.scrollUp.min.js"></script>
	<!-- mCustomScrollbar JS
        ============================================ -->
	<script src="js/scrollbar/jquery.mCustomScrollbar.concat.min.js"></script>
	<script src="js/scrollbar/mCustomScrollbar-active.js"></script>
	<!-- metisMenu JS
        ============================================ -->
	<script src="js/metisMenu/metisMenu.min.js"></script>
	<script src="js/metisMenu/metisMenu-active.js"></script>
	<!-- morrisjs JS
        ============================================ -->
	<script src="js/sparkline/jquery.sparkline.min.js"></script>
	<script src="js/sparkline/jquery.charts-sparkline.js"></script>
	<!-- calendar JS
        ============================================ -->
	<script src="js/calendar/moment.min.js"></script>
	<script src="js/calendar/fullcalendar.min.js"></script>
	<script src="js/calendar/fullcalendar-active.js"></script>
	<!-- plugins JS
        ============================================ -->
	<script src="js/plugins.js"></script>
	<!-- main JS
        ============================================ -->
	<script src="js/main.js"></script>


	<!-- tawk chat JS
        ============================================ -->
	<!-- <script src="js/tawk-chat.js"></script> -->
	



</body>

</html>

<script>
	var vue = new Vue({
		el:"#app",
		data:{
			pages:{},
			schedules:[],
			eDate:null,
			planId:null,
			planSeq:null,

			equipmentId:null,
			equipmentSeq:null,


			/*预处理，用于新建*/
			plans:[],
			products:[],
			equipments:[],
			/*新建*/
			level1:{},
			productId:null,
			productCount:null,
			equipmentId:null,
			scheduleCount:null,


			/*查询所使用的临时变量*/
			checkSchedule:{},



			/*查询结果*/
			schedules:[],

			/*修改工单的对象*/
			updateSchedule:{},
			upScheduleCount:null,
			upEquipmentId:null,


			//匹配dd/MM/yyyy的正则表达式
			regDate: /^([0]?[1-9]|[1|2][0-9]|[3][0|1])[/]([0]?[1-9]|[1][0-2])[/]([0-9]{4}|[0-9]{2})$/,

			toPlan:{},
			planStDate:null,
			planEndDate:null,

			comOrder:{},

			//这里一定要设置为""，不能设置null，null的话会传过去一个字符串'null'
			searchPlanSeq:"",
			searchScheduleSeq:"",
			searchProductName:"",



		},

		methods:{

			add:function(m){return m<10?'0'+m:m},

			fortime:function(timeStamp){
				var time = new Date(timeStamp);
				var y = time.getFullYear();
				var m = time.getMonth()+1;
				var d = time.getDate();
				return y+'-'+this.add(m)+'-'+this.add(d);
			},


			getPlans:function(){
				axios
						.get('http://localhost:8080/schedule/getPlans')
						.then(response =>{
							//清空产品集合对象
							this.plans=null;
			
							//取响应数据赋值给vue对象中的对象
							this.plans=response.data.data;
						})
						.catch(function (error) { // 请求失败处理
							console.log(error);
						});
			},
			
			getProducts:function(){
				axios
						.get('http://localhost:8080/schedule/getProducts')
						.then(response =>{
							//清空产品集合对象
							this.products=null;

							//取响应数据赋值给vue对象中的对象
							this.products=response.data.data;
						})
						.catch(function (error) { // 请求失败处理
							console.log(error);
						});
			},

			getEquipments:function(){
				axios
						.get('http://localhost:8080/schedule/getEquipments')
						.then(response =>{
							//清空集合对象
							this.equipments=null;

							//取响应数据赋值给vue对象中的对象
							this.equipments=response.data.data;
						})
						.catch(function (error) { // 请求失败处理
							console.log(error);
						});
			},


			refresh:function(){
				this.$forceUpdate();
			},

			deleteSchedule:function(index){
				const formData = new FormData();
				formData.append("id", this.schedules[index].id);
				axios
						.post("http://localhost:8080/schedule/deleteSchedule", formData)
						.then(response =>{
							if(response.data.result == true){
								// console.log(this.orders[2].orderStatus);
								this.searchScheduleByPage(1);
								this.$forceUpdate();
							}

						})
						.catch(function(error){
							console.log(error);
						});
			},

			//正常的显示。
			//不用获取当前查询的参数。当前参数只有在点击查询之后才会改变。
			//查询的时候是获取参数，然后再调用这个函数。
			searchScheduleByPage:function(i){
				formData = new FormData;
				formData.append("planSeq", this.searchPlanSeq);
				formData.append("scheduleSeq", this.searchScheduleSeq);
				formData.append("productName", this.searchProductName);
				axios
						.post("http://localhost:8080/schedule/searchScheduleByPage?page=" + i, formData)
						.then(response =>{
							//清空订单集合对象
							this.schedules=null;
							//清空page对象
							this.pages=null;
							//取响应数据赋值给vue对象中的对象
							this.schedules=response.data.schedules;
							this.pages=response.data.pages;
							for(var i = 0; i < this.schedules.length; i++){
								this.schedules[i].endDate = this.fortime(this.schedules[i].endDate);
								this.schedules[i].startDate = this.fortime(this.schedules[i].startDate);
							}

						})
						.catch(function(error){
							console.log(error);
						});
			},


			changeStatus:function(index, st) {

				var cur = this.schedules[index];

				const formData = new FormData();
				formData.append("id", cur.id);
				if(st == 2){
					formData.append("status", 2);
				} else if(st == 3){
					formData.append("status", 3);
				}
				axios
						.post("http://localhost:8080/schedule/changeStatus", formData)
						.then(response =>{
							if(response.data.result == true){
								// console.log(this.orders[2].orderStatus);
								this.schedules[index] = response.data.data;
								// console.log(response.data.data.orderStatus);
								// console.log(this.orders[2]);
								this.$forceUpdate();
							}

						})
						.catch(function(error){
							console.log(error);
						});

			},

			submitAddSchedule:function(){
			    const formData = new FormData();
			    this.sdate = this.$refs.addStDate.value;
			    this.edate = this.$refs.addEndDate.value;
			    formData.append("planId", this.level1.id);
			    formData.append("productId", this.level1.productId);
			    formData.append("scheduleCount", this.scheduleCount);
				formData.append("equipmentId", this.equipmentId);
			    formData.append("addsDate", this.sdate);
			    formData.append("addeDate", this.edate);

			    axios
			        .post("http://localhost:8080/schedule/addSchedule", formData)
			        .then(response =>{
			            if(response.data.result){
			                alert("新建成功！");
			                this.$refs.btnClose.click();
			                this.searchScheduleByPage(1);
			                //this.getPlans();
			                // window.location="http://localhost:8080/order.html";
			            }else{
			                alert(response.data.errMsg);
			            }
			        })
			        .catch(function (error) { // 请求失败处理
			            console.log(error);
			        });
			},

			submitUpdateSchedule:function(){
				const formData = new FormData();
				var upStartDate = this.$refs.upStartDate.value;
				var upEndDate = this.$refs.upEndDate.value;
				formData.append("scheduleId", this.updateSchedule.id);
				formData.append("scheduleCount", this.upScheduleCount);
				formData.append("equipmentId", this.upEquipmentId);
				formData.append("startDate", upStartDate);
				formData.append("endDate", upEndDate);

				axios
					.post("http://localhost:8080/schedule/updateSchedule", formData)
					.then(response =>{
						if(response.data.result){
							alert("编辑成功！");
							this.$refs.btnClose2.click();
							this.searchScheduleByPage(1);
							//this.getPlans();
							// window.location="http://localhost:8080/order.html";
						}else{
							alert(response.data.errMsg);
						}
					})
					.catch(function (error) { // 请求失败处理
						console.log(error);
					});
			},





			getSearchParam:function(){
				//点击查询按钮之后，获取数据，进行动态查询
				this.searchPlanSeq = this.$refs.search_planSeq.value;
				this.searchScheduleSeq = this.$refs.search_scheduleSeq.value;
				this.searchProductName = this.$refs.search_productName.value;
			},

			submitSearch:function(){

				this.getSearchParam();
				this.searchScheduleByPage(1);
			},
			getUser:function () {
				axios
						.get("http://localhost:8080/getUser")
						.then(response =>{
							if(response.data.result == true){
								this.userName = response.data.data;
							}else {
								alert("您未登录")
								window.location.href = 'http://localhost:8080/login.html';
							}
						})
						.catch(function(error){
							console.log(error);
						});
			},
			logout:function () {
				axios
						.get("http://localhost:8080/logout")
						.then(response =>{
							window.location.href = 'http://localhost:8080/login.html';
						})
						.catch(function(error){
							console.log(error);
						});
			}
		},

		created() {
			this.getUser();
		},



		mounted() {
			this.searchScheduleByPage(1);
			this.getPlans();
			this.getProducts();
			this.getEquipments();
		}
	})
</script>
<!-- datapicker JS
	============================================ -->
<script src="js/datapicker/bootstrap-datepicker.js"></script>
<script src="js/datapicker/datepicker-active.js"></script>



<!-- jquery
    ============================================ -->
<script src="js/vendor/jquery-1.12.4.min.js"></script>
<!-- bootstrap JS
    ============================================ -->
<script src="js/bootstrap.min.js"></script>
<!-- wow JS
    ============================================ -->
<script src="js/wow.min.js"></script>
<!-- price-slider JS
    ============================================ -->
<script src="js/jquery-price-slider.js"></script>
<!-- meanmenu JS
    ============================================ -->
<script src="js/jquery.meanmenu.js"></script>
<!-- owl.carousel JS
    ============================================ -->
<script src="js/owl.carousel.min.js"></script>
<!-- sticky JS
    ============================================ -->
<script src="js/jquery.sticky.js"></script>
<!-- scrollUp JS
    ============================================ -->
<script src="js/jquery.scrollUp.min.js"></script>
<!-- mCustomScrollbar JS
    ============================================ -->
<script src="js/scrollbar/jquery.mCustomScrollbar.concat.min.js"></script>
<script src="js/scrollbar/mCustomScrollbar-active.js"></script>
<!-- metisMenu JS
    ============================================ -->
<script src="js/metisMenu/metisMenu.min.js"></script>
<script src="js/metisMenu/metisMenu-active.js"></script>
<!-- morrisjs JS
    ============================================ -->
<script src="js/sparkline/jquery.sparkline.min.js"></script>
<script src="js/sparkline/jquery.charts-sparkline.js"></script>
<!-- calendar JS
    ============================================ -->
<script src="js/calendar/moment.min.js"></script>
<script src="js/calendar/fullcalendar.min.js"></script>
<script src="js/calendar/fullcalendar-active.js"></script>
<!-- plugins JS
    ============================================ -->
<script src="js/plugins.js"></script>
<!-- main JS
    ============================================ -->
<script src="js/main.js"></script>
