<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org" >
<head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <title>Library Assets | Kiaalap - Kiaalap Admin Template</title>
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- vue ajax -->
    <script src="js/jquery.min.js"></script>
    <script src="bootstrap/dist/js/bootstrap.min.js"></script>

    <script src="js/vue.js"></script>
    <script src="js/axios.min.js"></script>

    <!-- favicon
        ============================================ -->
    <link rel="shortcut icon" type="image/x-icon" href="img/favicon.ico">
    <!-- Google Fonts
        ============================================ -->
    <!-- <link href="https://fonts.googleapis.com/css?family=Roboto:100,300,400,700,900" rel="stylesheet"> -->
    <!-- Bootstrap CSS
        ============================================ -->
    <link rel="stylesheet" href="css/bootstrap.min.css">
    <!-- Bootstrap CSS
        ============================================ -->
    <link rel="stylesheet" href="css/font-awesome.min.css">
    <!-- owl.carousel CSS
        ============================================ -->
    <link rel="stylesheet" href="css/owl.carousel.css">
    <link rel="stylesheet" href="css/owl.theme.css">
    <link rel="stylesheet" href="css/owl.transitions.css">
    <!-- animate CSS
        ============================================ -->
    <link rel="stylesheet" href="css/animate.css">
    <!-- normalize CSS
        ============================================ -->
    <link rel="stylesheet" href="css/normalize.css">
    <!-- meanmenu icon CSS
        ============================================ -->
    <link rel="stylesheet" href="css/meanmenu.min.css">
    <!-- main CSS
        ============================================ -->
    <link rel="stylesheet" href="css/main.css">
    <!-- educate icon CSS
        ============================================ -->
    <link rel="stylesheet" href="css/educate-custon-icon.css">
    <!-- morrisjs CSS
        ============================================ -->
    <link rel="stylesheet" href="css/morrisjs/morris.css">
    <!-- mCustomScrollbar CSS
        ============================================ -->
    <link rel="stylesheet" href="css/scrollbar/jquery.mCustomScrollbar.min.css">
    <!-- metisMenu CSS
        ============================================ -->
    <link rel="stylesheet" href="css/metisMenu/metisMenu.min.css">
    <link rel="stylesheet" href="css/metisMenu/metisMenu-vertical.css">
    <!-- calendar CSS
        ============================================ -->
    <link rel="stylesheet" href="css/calendar/fullcalendar.min.css">
    <link rel="stylesheet" href="css/calendar/fullcalendar.print.min.css">
    <!-- style CSS
        ============================================ -->
    <link rel="stylesheet" href="css/style.css">
    <!-- responsive CSS
        ============================================ -->
    <link rel="stylesheet" href="css/responsive.css">
    <!-- modernizr JS
        ============================================ -->
    <script src="js/vendor/modernizr-2.8.3.min.js"></script>
    <!-- datapicker CSS
		============================================ -->
    <link rel="stylesheet" href="css/datapicker/datepicker3.css">
    <style>
        .add-order a {
            float: right;
            position: absolute;
            top: 20px;
            right: 35px;
            display: block;
            background: #006DF0;
            /* width: 120px; */
            padding: 6px 20px;
            /* margin: 0px 1100px; */
            color: #fff;
            border-radius: 4px;
            /* text-align: center; */
        }
        .search-order a {
            /* float: right; */
            /* position: absolute;
                  top: 40px;
                  right: 35px; */
            display: block;
            background: #006DF0;
            width: 120px;
            font-size: 15px;
            padding: 6px 20px;
            margin: 0px 70px;
            color: #fff;
            border-radius: 4px;
            text-align: center;
        }
        .input-group-addon{
            color: white;
            background-color: #009AD5;
        }
    </style>
</head>

<body>
<!-- Start Left menu area -->
<div class="left-sidebar-pro" >
    <nav id="sidebar" class="">
        <div class="sidebar-header">
            <a href="index.html"><img class="main-logo" src="img/logo/logo.png" alt="" /></a>
            <strong><a href="index.html"><img src="img/logo/logosn.png" alt="" /></a></strong>
        </div>
        <div class="left-custom-menu-adp-wrap comment-scrollbar">
            <nav class="sidebar-nav left-sidebar-menu-pro">
                <ul class="metismenu" id="menu1">
                    <li>
                        <a title="Landing Page" href="/login.html" aria-expanded="false"><span class="educate-icon educate-professor icon-wrap sub-icon-mg" aria-hidden="true"></span> <span class="mini-click-non">登录/注册</span></a>
                    </li>
                    <li>
                        <a title="Landing Page" href="/index.html" aria-expanded="false"><span class="educate-icon educate-apps icon-wrap sub-icon-mg" aria-hidden="true"></span> <span class="mini-click-non">工厂首页</span></a>
                    </li>
                    <li>
                        <a title="Landing Page" href="/product.html" aria-expanded="false"><span class="educate-icon educate-event icon-wrap sub-icon-mg" aria-hidden="true"></span> <span class="mini-click-non">产品管理</span></a>
                    </li>
                    <li>
                        <a title="Landing Page" href="/equipment.html" aria-expanded="false"><span class="educate-icon educate-event icon-wrap sub-icon-mg" aria-hidden="true"></span> <span class="mini-click-non">设备管理</span></a>
                    </li>
                    <li>
                        <a title="Landing Page" href="/order.html" aria-expanded="false"><span class="educate-icon educate-library icon-wrap sub-icon-mg" aria-hidden="true"></span> <span class="mini-click-non">订单管理</span></a>
                    </li>
                    <li>
                        <a title="Landing Page" href="/planmanage.html" aria-expanded="false"><span class="educate-icon educate-data-table icon-wrap sub-icon-mg" aria-hidden="true"></span> <span class="mini-click-non">生产计划管理</span></a>
                    </li>
                    <li>
                        <a title="Landing Page" href="/schedule.html" aria-expanded="false"><span class="educate-icon educate-event icon-wrap sub-icon-mg" aria-hidden="true"></span> <span class="mini-click-non">生产调度管理</span></a>
                    </li>
                    <li>
                        <a title="Landing Page" href="/ordertrack.html" aria-expanded="false"><span class="educate-icon educate-interface icon-wrap sub-icon-mg" aria-hidden="true"></span> <span class="mini-click-non">生产订单跟踪</span></a>
                    </li>
                </ul>
            </nav>
        </div>
    </nav>
</div>
<!-- End Left menu area -->
<!-- 主内容 -->
<div class="all-content-wrapper" id="app" >
    <div class="container-fluid">
        <div class="row">
            <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
                <div class="logo-pro">
                    <a href="index.html"><img class="main-logo" src="img/logo/logo.png" alt="" /></a>
                </div>
            </div>
        </div>
    </div>
    <div class="header-advance-area">
        <div class="header-top-area">
            <div class="container-fluid">
                <div class="row">
                    <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
                        <div class="header-top-wraper">
                            <div class="row">
                                <div class="col-lg-1 col-md-0 col-sm-1 col-xs-12">
                                    <div class="menu-switcher-pro">
                                        <button type="button" id="sidebarCollapse" class="btn bar-button-pro header-drl-controller-btn btn-info navbar-btn">
                                            <i class="educate-icon educate-nav"></i>
                                        </button>
                                    </div>
                                </div>
                                <div class="col-lg-6 col-md-7 col-sm-6 col-xs-12">
                                    <div class="header-top-menu tabl-d-n">
                                        <ul class="nav navbar-nav mai-top-nav">
                                            <li class="nav-item"><a href="#" class="nav-link">Home</a>
                                            </li>
                                        </ul>
                                    </div>
                                </div>
                                <div class="col-lg-5 col-md-5 col-sm-12 col-xs-12">
                                    <div class="header-right-info">
                                        <ul class="nav navbar-nav mai-top-nav header-right-menu">

                                            <li class="nav-item">
                                                <a href="#" data-toggle="dropdown" role="button" aria-expanded="false" class="nav-link dropdown-toggle">
                                                    <img src="" alt="" />
                                                    <span class="admin-name">{{userName}}</span>
                                                    <i class="fa fa-angle-down edu-icon edu-down-arrow"></i>
                                                </a>
                                                <ul role="menu" class="dropdown-header-top author-log dropdown-menu animated zoomIn">
                                                    <li><a @click="logout()"><span class="edu-icon edu-locked author-log-ic"></span>Log Out</a>
                                                    </li>
                                                </ul>
                                            </li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!-- Mobile Menu start -->
        <div class="mobile-menu-area">
            <div class="container">
                <div class="row">
                    <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
                        <div class="mobile-menu">
                            <nav id="dropdown">
                                <ul class="mobile-menu-nav">
                                    <li><a href="events.html">Event</a></li>
                                    <li><a data-toggle="collapse" data-target="#demoevent" href="#">Professors <span class="admin-project-icon edu-icon edu-down-arrow"></span></a>
                                        <ul id="demoevent" class="collapse dropdown-header-top">
                                            <li><a href="all-professors.html">All Professors</a>
                                            </li>
                                            <li><a href="add-professor.html">Add Professor</a>
                                            </li>
                                            <li><a href="edit-professor.html">Edit Professor</a>
                                            </li>
                                            <li><a href="professor-profile.html">Professor Profile</a>
                                            </li>
                                        </ul>
                                    </li>
                                    <li><a data-toggle="collapse" data-target="#demopro" href="#">Students <span class="admin-project-icon edu-icon edu-down-arrow"></span></a>
                                        <ul id="demopro" class="collapse dropdown-header-top">
                                            <li><a href="all-students.html">All Students</a>
                                            </li>
                                            <li><a href="add-student.html">Add Student</a>
                                            </li>
                                            <li><a href="edit-student.html">Edit Student</a>
                                            </li>
                                            <li><a href="student-profile.html">Student Profile</a>
                                            </li>
                                        </ul>
                                    </li>
                                    <li><a data-toggle="collapse" data-target="#democrou" href="#">Courses <span class="admin-project-icon edu-icon edu-down-arrow"></span></a>
                                        <ul id="democrou" class="collapse dropdown-header-top">
                                            <li><a href="all-courses.html">All Courses</a>
                                            </li>
                                            <li><a href="add-course.html">Add Course</a>
                                            </li>
                                            <li><a href="edit-course.html">Edit Course</a>
                                            </li>
                                            <li><a href="course-profile.html">Courses Info</a>
                                            </li>
                                            <li><a href="course-payment.html">Courses Payment</a>
                                            </li>
                                        </ul>
                                    </li>
                                    <li><a data-toggle="collapse" data-target="#demolibra" href="#">Library <span class="admin-project-icon edu-icon edu-down-arrow"></span></a>
                                        <ul id="demolibra" class="collapse dropdown-header-top">
                                            <li><a href="library-assets.html">Library Assets</a>
                                            </li>
                                            <li><a href="add-library-assets.html">Add Library Asset</a>
                                            </li>
                                            <li><a href="edit-library-assets.html">Edit Library Asset</a>
                                            </li>
                                        </ul>
                                    </li>
                                    <li><a data-toggle="collapse" data-target="#demodepart" href="#">Departments <span class="admin-project-icon edu-icon edu-down-arrow"></span></a>
                                        <ul id="demodepart" class="collapse dropdown-header-top">
                                            <li><a href="departments.html">Departments List</a>
                                            </li>
                                            <li><a href="add-department.html">Add Departments</a>
                                            </li>
                                            <li><a href="edit-department.html">Edit Departments</a>
                                            </li>
                                        </ul>
                                    </li>
                                    <li><a data-toggle="collapse" data-target="#demo" href="#">Mailbox <span class="admin-project-icon edu-icon edu-down-arrow"></span></a>
                                        <ul id="demo" class="collapse dropdown-header-top">
                                            <li><a href="mailbox.html">Inbox</a>
                                            </li>
                                            <li><a href="mailbox-view.html">View Mail</a>
                                            </li>
                                            <li><a href="mailbox-compose.html">Compose Mail</a>
                                            </li>
                                        </ul>
                                    </li>
                                    <li><a data-toggle="collapse" data-target="#Miscellaneousmob" href="#">Interface <span class="admin-project-icon edu-icon edu-down-arrow"></span></a>
                                        <ul id="Miscellaneousmob" class="collapse dropdown-header-top">
                                            <li><a href="google-map.html">Google Map</a>
                                            </li>
                                            <li><a href="data-maps.html">Data Maps</a>
                                            </li>
                                            <li><a href="pdf-viewer.html">Pdf Viewer</a>
                                            </li>
                                            <li><a href="x-editable.html">X-Editable</a>
                                            </li>
                                            <li><a href="code-editor.html">Code Editor</a>
                                            </li>
                                            <li><a href="tree-view.html">Tree View</a>
                                            </li>
                                            <li><a href="preloader.html">Preloader</a>
                                            </li>
                                            <li><a href="images-cropper.html">Images Cropper</a>
                                            </li>
                                        </ul>
                                    </li>
                                    <li><a data-toggle="collapse" data-target="#Chartsmob" href="#">Charts <span class="admin-project-icon edu-icon edu-down-arrow"></span></a>
                                        <ul id="Chartsmob" class="collapse dropdown-header-top">
                                            <li><a href="bar-charts.html">Bar Charts</a>
                                            </li>
                                            <li><a href="line-charts.html">Line Charts</a>
                                            </li>
                                            <li><a href="area-charts.html">Area Charts</a>
                                            </li>
                                            <li><a href="rounded-chart.html">Rounded Charts</a>
                                            </li>
                                            <li><a href="c3.html">C3 Charts</a>
                                            </li>
                                            <li><a href="sparkline.html">Sparkline Charts</a>
                                            </li>
                                            <li><a href="peity.html">Peity Charts</a>
                                            </li>
                                        </ul>
                                    </li>
                                    <li><a data-toggle="collapse" data-target="#Tablesmob" href="#">Tables <span class="admin-project-icon edu-icon edu-down-arrow"></span></a>
                                        <ul id="Tablesmob" class="collapse dropdown-header-top">
                                            <li><a href="static-table.html">Static Table</a>
                                            </li>
                                            <li><a href="data-table.html">Data Table</a>
                                            </li>
                                        </ul>
                                    </li>
                                    <li><a data-toggle="collapse" data-target="#formsmob" href="#">Forms <span class="admin-project-icon edu-icon edu-down-arrow"></span></a>
                                        <ul id="formsmob" class="collapse dropdown-header-top">
                                            <li><a href="basic-form-element.html">Basic Form Elements</a>
                                            </li>
                                            <li><a href="advance-form-element.html">Advanced Form Elements</a>
                                            </li>
                                            <li><a href="password-meter.html">Password Meter</a>
                                            </li>
                                            <li><a href="multi-upload.html">Multi Upload</a>
                                            </li>
                                            <li><a href="tinymc.html">Text Editor</a>
                                            </li>
                                            <li><a href="dual-list-box.html">Dual List Box</a>
                                            </li>
                                        </ul>
                                    </li>
                                    <li><a data-toggle="collapse" data-target="#Appviewsmob" href="#">App views <span class="admin-project-icon edu-icon edu-down-arrow"></span></a>
                                        <ul id="Appviewsmob" class="collapse dropdown-header-top">
                                            <li><a href="basic-form-element.html">Basic Form Elements</a>
                                            </li>
                                            <li><a href="advance-form-element.html">Advanced Form Elements</a>
                                            </li>
                                            <li><a href="password-meter.html">Password Meter</a>
                                            </li>
                                            <li><a href="multi-upload.html">Multi Upload</a>
                                            </li>
                                            <li><a href="tinymc.html">Text Editor</a>
                                            </li>
                                            <li><a href="dual-list-box.html">Dual List Box</a>
                                            </li>
                                        </ul>
                                    </li>
                                    <li><a data-toggle="collapse" data-target="#Pagemob" href="#">Pages <span class="admin-project-icon edu-icon edu-down-arrow"></span></a>
                                        <ul id="Pagemob" class="collapse dropdown-header-top">
                                            <li><a href="login.html">Login</a>
                                            </li>
                                            <li><a href="register.html">Register</a>
                                            </li>
                                            <li><a href="lock.html">Lock</a>
                                            </li>
                                            <li><a href="password-recovery.html">Password Recovery</a>
                                            </li>
                                            <li><a href="404.html">404 Page</a></li>
                                            <li><a href="500.html">500 Page</a></li>
                                        </ul>
                                    </li>
                                </ul>
                            </nav>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Mobile Menu end -->
        <div class="breadcome-area">
            <div class="container-fluid">
                <div class="row">
                    <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
                        <div class="breadcome-list single-page-breadcome">
                            <div class="row">
                                <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12 form-horizontal">
                                    <div class="col-lg-3">
                                        <div class="input-group" >
                                            <span class="input-group-addon">计划编号</span>
                                            <input type="text" placeholder="计划编号" class="form-control" ref="search_planseq">
                                        </div>
                                    </div>
                                    <div class="col-lg-3">
                                        <div class="input-group" >
                                            <span class="input-group-addon">订单编号</span>
                                            <input type="text" placeholder="订单编号" class="form-control" ref="search_orderseq">
                                        </div>
                                    </div>
                                    <div class="col-lg-2 ">
                                        <div class="input-group" >
                                            <span class="input-group-addon">计划状态</span>
                                            <select class="form-control" tabindex="-1" id="" name=""
                                                    placeholder="请选择" ref="search_status">
                                                <option value="">请选择</option>
                                                <option value="3">未启动</option>
                                                <option value="1">已启动</option>
                                                <option value="2">已完成</option>
                                            </select>
                                        </div>

                                    </div>
                                    <div class="col-lg-2">
                                        <div class="input-group">
                                            <span class="input-group-addon">产品名称</span>
                                            <input type="text" placeholder="产品名称" class="form-control" ref="search_pro">
                                        </div>
                                    </div>
                                    <div class="col-lg-2 search-order">
                                        <a href="#" @click.prevent="submitSearch(1)"><i class="fa fa-search"></i>查询计划</a>
                                    </div>
                                </div>
                                <!--                                <div class="search-order">-->
                                <!--                                    &lt;!&ndash; 触发search事件， 显示第一页 &ndash;&gt;-->
                                <!--                                    <a href="#" @click.prevent="submitSearch(1)"><i class="fa fa-search"></i>查询计划</a>-->
                                <!--                                </div>-->
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>


    </div>

    <div class="product-status mg-b-15"  >
        <div class="container-fluid">
            <div class="row">
                <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12 ">
                    <div class="product-status-wrap">
                        <div class="add-order" data-toggle="modal"
                             data-target="#myModalAddPlan">
                            <a href="#">新建计划</a>
                        </div>
                        <h4>生产计划列表</h4>
                        <div class="asset-inner">
                            <table>
                                <tr>
                                    <th>序号</th>
                                    <th>计划编号</th>
                                    <th>订单编号</th>
                                    <th>产品</th>
                                    <th>数量</th>
                                    <th>交货日期</th>
                                    <th>计划开始日期</th>
                                    <th>计划结束日期</th>
                                    <th>计划状态</th>
                                    <th style="text-align: center; width: 250px;">操作</th>
                                </tr>
                                <tr v-for="(TProductPlan, index) in tproductplans">
                                    <td>{{index + 1}}</td>
                                    <td>{{TProductPlan.planSeq}}</td>
                                    <td>{{TProductPlan.orderSeq}}</td>
                                    <td>{{TProductPlan.productName}}</td>
                                    <td>{{TProductPlan.planCount}}</td>
                                    <td>{{TProductPlan.deliveryDate}}</td>
                                    <td>{{TProductPlan.planStartDate}}</td>
                                    <td>{{TProductPlan.planEndDate}}</td>
                                    <td>
                                        <button class="ps-setting" v-if="TProductPlan.planStatus == 3" >未启动</button>
                                        <button class="pd-setting" v-if="TProductPlan.planStatus == 1" >已启动</button>
                                        <button class="su-setting" v-if="TProductPlan.planStatus == 2" >已完成</button>
                                    </td>
                                    <td style="text-align: center">
                                        <a v-if="(TProductPlan.planStatus==3)"><button data-toggle="tooltip" title="Start" class="pd-setting-ed"><i class="fa fa-play-circle" aria-hidden="true" @click="changeStatus(index, 1)">启动</i></button></a>
                                        <a v-if="(TProductPlan.planStatus==3)"><button data-toggle="tooltip" title="Edit" class="pd-setting-ed"><i class="fa fa-pencil-square-o" aria-hidden="true" data-toggle="modal" data-target="#myModalUpdatePlan" @click="updateplan=tproductplans[index]">编辑</i></button></a>
                                        <a v-if="(TProductPlan.planStatus==3)"><button data-toggle="tooltip" title="Delete" class="pd-setting-ed"><i class="fa fa-trash-o" aria-hidden="true" @click="deleteplan(TProductPlan.id)">删除</i></button></a>
                                        <a v-if="(TProductPlan.planStatus!=3)"><button data-toggle="tooltip" title="Search" class="pd-setting-ed"><i class="fa fa-search" aria-hidden="true" data-toggle="modal" data-target="#myModalGetPlan" @click="getplan=tproductplans[index]">查看</i></button></a>
                                    </td>
                                </tr>

                            </table>
                        </div>
                        <!-- 分页-->

                        <ul class="pagination">

                        </ul>
                        <div class="custom-pagination">
                            <ul class="pagination">
                                <li class="page-item"><a class="page-link" href="#"
                                                         @click="pages.pageNo == 1 ? pages.pageNo = 1 : pages.pageNo -= 1; getPlanByPage(pages.pageNo);">上一页</a></li>
                                <li   v-for="i in pages.totalPage"  :class="[pages.pageNo != i ? '':'active']" >
                                    <a href="#" @click.prevent="getPlanByPage(i)">{{i}}</a>
                                </li>

                                <li class="page-item"><a class="page-link" href="#"
                                                         @click="pages.pageNo == pages.totalPage ? pages.pageNo = pages.totalPage : pages.pageNo += 1; getPlanByPage(pages.pageNo);">下一页</a></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>

    </div>

    <div class="modal fade" id="myModalAddPlan"
         tabindex="-1" role="dialog"
         aria-labelledby="myModalLabel" aria-hidden="true" >
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">
                        &times;
                    </button>
                    <h4 class="modal-title" id="myModalAddLabel">
                        新建生产计划
                    </h4>
                </div>
                <div class="modal-body form-horizontal" style="height: 400px;">
                    <div class="form-group col-lg-12">
                        <label for="addorderSeq" class="col-lg-3 control-label">订单编号：</label>
                        <div class="col-lg-9">
                            <select class="form-control" tabindex="-1" id="addorderSeq" name="addorderSeq" v-model="orderId">
                                <option value="">请选择订单</option>
                                <option v-for="order in orders" :value="order.id">{{order.orderSeq}}</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-group col-lg-12">
                        <label for="addpname" class="col-lg-3 control-label">产品名称：</label>
                        <div class="col-lg-9">
                            <select class="form-control" tabindex="-1" id="addpname" name="addpname" v-model="productId">
                                <option value="">请选择产品</option>
                                <option v-for="product in products" :value="product.id">{{product.productName}}</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-group col-lg-12">
                        <label for="addplannum" class="col-lg-3 control-label">数量：</label>
                        <div class="col-lg-9">
                            <input type="text" class="form-control" id="addplannum" name="addplannum" placeholder="输入数量" v-model="plannum"/>
                        </div>
                    </div>


                    <div class="form-group  col-lg-12" id="data_2">
                        <label for="addedate" class="col-lg-3 control-label">交货日期：</label>
                        <div class="input-group date col-lg-9">
                            <span class="input-group-addon"><i class="fa fa-calendar"></i></span>
                            <input type="text" class="form-control" id="addddate" ref="addddate" />
                        </div>
                    </div>
                    <div class="form-group  col-lg-12" id="data_2">
                        <label for="addedate" class="col-lg-3 control-label">计划开始日期:</label>
                        <div class="input-group date col-lg-9">
                            <span class="input-group-addon"><i class="fa fa-calendar"></i></span>
                            <input type="text" class="form-control" id="addsdate" ref="addsdate" />
                        </div>
                    </div>
                    <div class="form-group  col-lg-12" id="data_2">
                        <label for="addedate" class="col-lg-3 control-label">计划结束日期：</label>
                        <div class="input-group date col-lg-9">
                            <span class="input-group-addon"><i class="fa fa-calendar"></i></span>
                            <input type="text" class="form-control" id="addedate" ref="addedate" />
                        </div>
                    </div>
                    <!--					<p v-if="errors.length">-->
                    <!--					<ul>-->
                    <!--						<li class="text-danger" v-for="error in errors">{{ error }}</li>-->
                    <!--					</ul>-->
                    <!--					</p>-->




                </div>

                <div class="modal-footer">
                    <div>
                        <button type="button" ref="btnClose" class="btn btn-default"
                                data-dismiss="modal">关闭
                        </button>
                        <button type="button" class="btn btn-primary" @click="submitAddplan()">
                            创建
                        </button>
                    </div>
                </div>
            </div><!-- /.modal-content -->
        </div><!-- /.modal -->
    </div>

    <div class="modal fade" id="myModalUpdatePlan"
         tabindex="-1" role="dialog"
         aria-labelledby="myModalLabel" aria-hidden="true" >
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">
                        &times;
                    </button>
                    <h4 class="modal-title" id="myModalUpdateLabel">
                        编辑生产计划
                    </h4>
                </div>
                <div class="modal-body form-horizontal" style="height: 400px;">

                    <div class="form-group col-lg-12">
                        <label for="updateplanSeq" class="col-lg-3 control-label">计划编号：</label>
                        <div class="col-lg-9">
                            <input type="text" disabled="true" class="form-control" id="updateplanSeq" name="planSeq" :value="updateplan.planSeq">
                        </div>
                    </div>

                    <div class="form-group col-lg-12">
                        <label for="updateorderSeq" class="col-lg-3 control-label">订单编号：</label>
                        <div class="col-lg-9">
                            <input type="text" disabled="true" class="form-control" id="updateorderSeq" name="oseq" :value="updateplan.orderSeq">
                        </div>
                    </div>

                    <div class="form-group col-lg-12">
                        <label for="updatepname" class="col-lg-3 control-label">产品名称：</label>
                        <div class="col-lg-9">
                            <input type="text" disabled="true" class="form-control" id="updatepname" name="pname" :value="updateplan.productName">
                        </div>
                    </div>

                    <!--                    <div class="form-group col-lg-12">-->
                    <!--                        <label for="updateplannum" class="col-lg-3 control-label">计划数量：</label>-->
                    <!--                        <div class="col-lg-9">-->
                    <!--                            <input type="text" disabled="true" class="form-control" id="updateplannum" name="plannum" :value="updateplan.planCount">-->
                    <!--                        </div>-->
                    <!--                    </div>-->

                    <div class="form-group col-lg-12">
                        <label for="updateplannum" class="col-lg-3 control-label">计划数量：</label>
                        <div class="col-lg-9">
                            <input type="text" class="form-control" id="updateplannum" name="plannum" placeholder="输入数量" v-model="plannum"/>
                        </div>
                    </div>


                    <div class="form-group  col-lg-12" id="data_2">
                        <label for="updateddate" class="col-lg-3 control-label">交货日期：</label>
                        <div class="input-group date col-lg-9">
                            <span class="input-group-addon"><i class="fa fa-calendar"></i></span>
                            <input type="text" class="form-control" id="updateddate"  ref="updateddate" />
                        </div>
                    </div>
                    <div class="form-group  col-lg-12" id="data_2">
                        <label for="updatesdate" class="col-lg-3 control-label">计划开始日期:</label>
                        <div class="input-group date col-lg-9">
                            <span class="input-group-addon"><i class="fa fa-calendar"></i></span>
                            <input type="text" class="form-control" id="updatesdate"  ref="updatesdate" />
                        </div>
                    </div>
                    <div class="form-group  col-lg-12" id="data_2">
                        <label for="updateedate" class="col-lg-3 control-label">计划结束日期：</label>
                        <div class="input-group date col-lg-9">
                            <span class="input-group-addon"><i class="fa fa-calendar"></i></span>
                            <input type="text" class="form-control" id="updateedate"  ref="updateedate" />
                        </div>
                    </div>
                    <!--					<p v-if="errors.length">-->
                    <!--					<ul>-->
                    <!--						<li class="text-danger" v-for="error in errors">{{ error }}</li>-->
                    <!--					</ul>-->
                    <!--					</p>-->




                </div>

                <div class="modal-footer">
                    <div>
                        <button type="button" ref="btnClose2" class="btn btn-default"
                                data-dismiss="modal">关闭
                        </button>
                        <button type="button" class="btn btn-primary" @click="submitUpdateplan()">
                            提交
                        </button>
                    </div>
                </div>
            </div><!-- /.modal-content -->
        </div><!-- /.modal -->
    </div>

    <div class="modal fade" id="myModalGetPlan"
         tabindex="-1" role="dialog"
         aria-labelledby="myModalLabel" aria-hidden="true" >
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">
                        &times;
                    </button>
                    <h4 class="modal-title" id="myModalGetLabel">
                        查看生产计划
                    </h4>
                </div>
                <div class="modal-body form-horizontal" style="height: 300px;">


                    <div class="form-group col-lg-12">
                        <div class="col-lg-4">
                            <h4>计划编号：</h4>
                        </div>
                        <div class="col-lg-6">
                            <h4>{{getplan.planSeq}}</h4>
                        </div>
                    </div>
                    <div class="form-group col-lg-12">
                        <div class="col-lg-4">
                            <h4>订单编号：</h4>
                        </div>
                        <div class="col-lg-6">
                            <h4>{{getplan.orderSeq}}</h4>
                        </div>
                    </div>
                    <div class="form-group col-lg-12">
                        <div class="col-lg-4">
                            <h4>产品名称：</h4>
                        </div>
                        <div class="col-lg-6">
                            <h4>{{getplan.productName}}</h4>
                        </div>
                    </div>
                    <div class="form-group col-lg-12">
                        <div class="col-lg-4">
                            <h4>数量：</h4>
                        </div>
                        <div class="col-lg-6">
                            <h4>{{getplan.planCount}}</h4>
                        </div>
                    </div>
                    <div class="form-group col-lg-12">
                        <div class="col-lg-4">
                            <h4>交货日期：</h4>
                        </div>
                        <div class="col-lg-6">
                            <h4>{{getplan.deliveryDate}}</h4>
                        </div>
                    </div>
                    <div class="form-group col-lg-12">
                        <div class="col-lg-4">
                            <h4>计划开始日期：</h4>
                        </div>
                        <div class="col-lg-6">
                            <h4>{{getplan.planStartDate}}</h4>
                        </div>
                    </div>
                    <div class="form-group col-lg-12">
                        <div class="col-lg-4">
                            <h4>计划结束日期：</h4>
                        </div>
                        <div class="col-lg-6">
                            <h4>{{getplan.planEndDate}}</h4>
                        </div>
                    </div>
                    <!--                    -->




                    <!--					<p v-if="errors.length">-->
                    <!--					<ul>-->
                    <!--						<li class="text-danger" v-for="error in errors">{{ error }}</li>-->
                    <!--					</ul>-->
                    <!--					</p>-->




                </div>

                <div class="modal-footer">
                    <div>
                        <button type="button" class="btn btn-default"
                                data-dismiss="modal">关闭
                        </button>
                        <!--                        <button type="button" class="btn btn-primary" @click="submitAdd()">-->
                        <!--                            创建-->
                        <!--                        </button>-->
                    </div>
                </div>
            </div><!-- /.modal-content -->
        </div><!-- /.modal -->
    </div>
    <!-- 主内容结束 -->

</div>

<!-- jquery
    ============================================ -->
<script src="js/vendor/jquery-1.12.4.min.js"></script>
<!-- bootstrap JS
    ============================================ -->
<script src="js/bootstrap.min.js"></script>
<!-- wow JS
    ============================================ -->
<script src="js/wow.min.js"></script>
<!-- price-slider JS
    ============================================ -->
<script src="js/jquery-price-slider.js"></script>
<!-- meanmenu JS
    ============================================ -->
<script src="js/jquery.meanmenu.js"></script>
<!-- owl.carousel JS
    ============================================ -->
<script src="js/owl.carousel.min.js"></script>
<!-- sticky JS
    ============================================ -->
<script src="js/jquery.sticky.js"></script>
<!-- scrollUp JS
    ============================================ -->
<script src="js/jquery.scrollUp.min.js"></script>
<!-- mCustomScrollbar JS
    ============================================ -->
<script src="js/scrollbar/jquery.mCustomScrollbar.concat.min.js"></script>
<script src="js/scrollbar/mCustomScrollbar-active.js"></script>
<!-- metisMenu JS
    ============================================ -->
<script src="js/metisMenu/metisMenu.min.js"></script>
<script src="js/metisMenu/metisMenu-active.js"></script>
<!-- morrisjs JS
    ============================================ -->
<script src="js/sparkline/jquery.sparkline.min.js"></script>
<script src="js/sparkline/jquery.charts-sparkline.js"></script>
<!-- calendar JS
    ============================================ -->
<script src="js/calendar/moment.min.js"></script>
<script src="js/calendar/fullcalendar.min.js"></script>
<script src="js/calendar/fullcalendar-active.js"></script>
<!-- plugins JS
    ============================================ -->
<script src="js/plugins.js"></script>
<!-- main JS
    ============================================ -->
<script src="js/main.js"></script>
<!-- tawk chat JS
    ============================================ -->
<!-- <script src="js/tawk-chat.js"></script> -->

</body>
</html>

<script>
    var vue = new Vue({
        el: "#app",
        data: {
            test:"cxl",
            info: null,
            orders: [],
            products:[],
            tproductplans: {},
            pages:{},
            planSeq:null,
            orderSeq:null,
            orderId:null,
            planId:null,
            pname:null,
            productId:null,
            productName:null,
            plannum:null,
            ddate:null,
            sdate:null,
            edate:null,
            createid:null,
            createtime:null,
            updateid:null,
            updatetime:null,
            updateplan:{},
            getplan:{},
            // search_planseq:null,
            // search_orderseq:null,
            // search_status:null,
            // search_pro:null,
            searchPlanSeq:"",
            searchOrderSeq:"",
            searchStatus:"",
            searchPro:"",
        },



        mounted() {
            this.getPlanByPage(1);


            axios
                .get('http://localhost:8080/plan/getProducts')
                .then(response =>{
                    //清空产品集合对象
                    this.products=null;

                    //取响应数据赋值给vue对象中的对象
                    this.products=response.data.data;
                })
                .catch(function (error) { // 请求失败处理
                    console.log(error);
                });

            axios
                .get('http://localhost:8080/plan/getOrders')
                .then(response =>{
                    //清空产品集合对象
                    this.orders=null;

                    //取响应数据赋值给vue对象中的对象
                    this.orders=response.data.data;
                })
                .catch(function (error) { // 请求失败处理
                    console.log(error);
                });

        },
        methods: {
            add:function(m){return m<10?'0'+m:m},

            fortime:function(timeStamp){
                var time = new Date(timeStamp);
                var y = time.getFullYear();
                var m = time.getMonth()+1;
                var d = time.getDate();
                return y+'-'+this.add(m)+'-'+this.add(d);
            },

            getPlanByPage: function (i) {
                formData = new FormData;
                formData.append("planSeq", this.searchPlanSeq);
                formData.append("orderSeq", this.searchOrderSeq);
                formData.append("planStatus", this.searchStatus);
                formData.append("productName", this.searchPro);
                axios
                    .post('http://localhost:8080/plan/searchPlanByPage?page=' + i,formData)
                    .then(response => {
                        //清空订单集合对象
                        this.tproductplans = null;
                        //清空page对象
                        this.pages = null;
                        //取响应数据赋值给vue对象中的对象
                        this.tproductplans = response.data.plans;
                        this.pages = response.data.pages;
                        for(var i = 0; i < this.tproductplans.length; i++){
                            this.tproductplans[i].deliveryDate = this.fortime(this.tproductplans[i].deliveryDate);
                            this.tproductplans[i].planStartDate = this.fortime(this.tproductplans[i].planStartDate);
                            this.tproductplans[i].planEndDate = this.fortime(this.tproductplans[i].planEndDate);
                        }

                    })
                    .catch(function (error) { // 请求失败处理
                        console.log(error);
                    });
            },

            deleteplan: function (a) {
                axios
                    .get('http://localhost:8080/plan/delete?id=' + a)
                    .then(response => {
                            // this.tproductplans = null;
                            // this.tproductplans = response.data.tproductplans;
                            // this.$forceUpdate();
                            this.getPlanByPage(1);
                        }
                    )
                    .catch(function (error) { // 请求失败处理
                        console.log(error);
                    });

            },

            changeStatus: function (index, st) {
                console.log(this.tproductplans[0].id)
                var cur = this.tproductplans[index];

                console.log(index);
                console.log(st);

                const formData = new FormData();
                var jsonPlan = JSON.stringify(cur);
                console.log(111);
                formData.append("plan", jsonPlan);
                formData.append("id", cur.id);
                if (st == 1) {
                    formData.append("status", 1);}

                axios
                    .post("http://localhost:8080/plan/addschedule", formData)
                    .then(response => {
                        if (response.data.result == true) {
                            // console.log(this.orders[2].orderStatus);
                            // this.tproductplans[index] = response.data.data;
                            // console.log(response.data.data.orderStatus);
                            // console.log(this.orders[2]);
                            // this.tproductplans[index].deliveryDate = this.fortime(this.tproductplans[index].deliveryDate);
                            // this.tproductplans[index].planStartDate = this.fortime(this.tproductplans[index].planStartDate);
                            // this.tproductplans[index].planEndDate = this.fortime(this.tproductplans[index].planEndDate);
                            // this.$forceUpdate();
                        }

                    })
                    .catch(function (error) {
                        console.log(error);
                    })

                axios
                    .post("http://localhost:8080/plan/planStatus", formData)
                    .then(response => {
                        if (response.data.result == true) {
                            // console.log(this.orders[2].orderStatus);
                            this.tproductplans[index] = response.data.data;
                            // console.log(response.data.data.orderStatus);
                            // console.log(this.orders[2]);
                            this.tproductplans[index].deliveryDate = this.fortime(this.tproductplans[index].deliveryDate);
                            this.tproductplans[index].planStartDate = this.fortime(this.tproductplans[index].planStartDate);
                            this.tproductplans[index].planEndDate = this.fortime(this.tproductplans[index].planEndDate);
                            alert("启动成功！");
                            this.getPlanByPage(1);
                        }

                    })
                    .catch(function (error) {
                        console.log(error);
                    });


            },

            submitAddplan:function(){
                const formData = new FormData();
                this.ddate = this.$refs.addddate.value;
                this.sdate = this.$refs.addsdate.value;
                this.edate = this.$refs.addedate.value;
                formData.append("orderId", this.orderId);
                formData.append("productId", this.productId);
                formData.append("planCount", this.plannum);
                formData.append("adddDate", this.ddate);
                formData.append("addsDate", this.sdate);
                formData.append("addeDate", this.edate);

                axios
                    .post("http://localhost:8080/plan/addPlan", formData)
                    .then(response =>{
                        if(response.data.result){
                            alert("新建成功！");
                            this.$refs.btnClose.click();
                            this.getPlanByPage(1);
                            //this.getPlans();
                            // window.location="http://localhost:8080/order.html";
                        }else{
                            alert(response.data.errMsg);
                        }
                    })
                    .catch(function (error) { // 请求失败处理
                        console.log(error);
                    });
            },

            submitUpdateplan:function () {
                const formData = new FormData();
                this.ddate = this.$refs.updateddate.value;
                this.sdate = this.$refs.updatesdate.value;
                this.edate = this.$refs.updateedate.value;
                var jsonPlan = JSON.stringify(this.updateplan);
                console.log(111);
                formData.append("plan", jsonPlan);
                formData.append("planCount", this.plannum);
                formData.append("updatedDate", this.ddate);
                formData.append("updatesDate", this.sdate);
                formData.append("updateeDate", this.edate);

                axios
                    .post("http://localhost:8080/plan/updatePlan", formData)
                    .then(response =>{
                        if(response.data.result){
                            alert("编辑成功！");
                            this.$refs.btnClose2.click();
                            this.getPlanByPage(1);
                            //this.getPlans();
                            // window.location="http://localhost:8080/order.html";
                        }else{
                            alert(response.data.errMsg);
                        }
                    })
                    .catch(function (error) { // 请求失败处理
                        console.log(error);
                    });

            },

            getSearchParam:function(){
                //点击查询按钮之后，获取数据，进行动态查询
                this.searchPlanSeq = this.$refs.search_planseq.value;
                this.searchOrderSeq = this.$refs.search_orderseq.value;
                this.searchStatus = this.$refs.search_status.value;
                this.searchPro = this.$refs.search_pro.value;
            },

            submitSearch:function(){

                this.getSearchParam();
                this.getPlanByPage(1);
            },
            getUser:function () {
                axios
                    .get("http://localhost:8080/getUser")
                    .then(response =>{
                        if(response.data.result == true){
                            this.userName = response.data.data;
                        }else {
                            alert("您未登录")
                            window.location.href = 'http://localhost:8080/login.html';
                        }
                    })
                    .catch(function(error){
                        console.log(error);
                    });
            },
            logout:function () {
                axios
                    .get("http://localhost:8080/logout")
                    .then(response =>{
                        window.location.href = 'http://localhost:8080/login.html';
                    })
                    .catch(function(error){
                        console.log(error);
                    });
            }

        },
        created() {
            this.getUser();
        },




    })
</script>
<!-- datapicker JS
	============================================ -->
<script src="js/datapicker/bootstrap-datepicker.js"></script>
<script src="js/datapicker/datepicker-active.js"></script>

<!-- jquery
    ============================================ -->
<script src="js/vendor/jquery-1.12.4.min.js"></script>
<!-- bootstrap JS
    ============================================ -->
<script src="js/bootstrap.min.js"></script>
<!-- wow JS
    ============================================ -->
<script src="js/wow.min.js"></script>
<!-- price-slider JS
    ============================================ -->
<script src="js/jquery-price-slider.js"></script>
<!-- meanmenu JS
    ============================================ -->
<script src="js/jquery.meanmenu.js"></script>
<!-- owl.carousel JS
    ============================================ -->
<script src="js/owl.carousel.min.js"></script>
<!-- sticky JS
    ============================================ -->
<script src="js/jquery.sticky.js"></script>
<!-- scrollUp JS
    ============================================ -->
<script src="js/jquery.scrollUp.min.js"></script>
<!-- mCustomScrollbar JS
    ============================================ -->
<script src="js/scrollbar/jquery.mCustomScrollbar.concat.min.js"></script>
<script src="js/scrollbar/mCustomScrollbar-active.js"></script>
<!-- metisMenu JS
    ============================================ -->
<script src="js/metisMenu/metisMenu.min.js"></script>
<script src="js/metisMenu/metisMenu-active.js"></script>
<!-- morrisjs JS
    ============================================ -->
<script src="js/sparkline/jquery.sparkline.min.js"></script>
<script src="js/sparkline/jquery.charts-sparkline.js"></script>
<!-- calendar JS
    ============================================ -->
<script src="js/calendar/moment.min.js"></script>
<script src="js/calendar/fullcalendar.min.js"></script>
<script src="js/calendar/fullcalendar-active.js"></script>
<!-- plugins JS
    ============================================ -->
<script src="js/plugins.js"></script>
<!-- main JS
    ============================================ -->
<script src="js/main.js"></script>
<!-- tawk chat JS
    ============================================ -->
<!-- <script src="js/tawk-chat.js"></script> -->

